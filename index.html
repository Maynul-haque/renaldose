<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neonatal Renal Dose Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
            color: #334155; /* Dark slate text */
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top for better content flow */
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 800px;
            margin-top: 20px; /* Space from top */
        }
        h1 {
            color: #1e293b; /* Darker slate for headings */
            text-align: center;
            margin-bottom: 25px;
            font-weight: 700;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #475569; /* Medium slate for labels */
        }
        input[type="number"],
        input[type="text"],
        select {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #cbd5e1; /* Light gray border */
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        input[type="number"]:focus,
        input[type="text"]:focus,
        select:focus {
            border-color: #6366f1; /* Indigo on focus */
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
            outline: none;
        }
        button {
            background-color: #6366f1; /* Indigo button */
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.2s, transform 0.1s;
        }
        button:hover {
            background-color: #4f46e5; /* Darker indigo on hover */
            transform: translateY(-1px);
        }
        .section-title {
            font-size: 1.25rem; /* Equivalent to text-xl */
            font-weight: 600;
            color: #1e293b;
            margin-top: 25px;
            margin-bottom: 15px;
            border-bottom: 2px solid #e2e8f0; /* Light border under section title */
            padding-bottom: 8px;
        }
        .radio-group {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        .radio-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: 400; /* Regular font weight for radio labels */
        }
        .radio-group input[type="radio"] {
            margin-right: 8px;
            width: auto; /* Override full width for radio buttons */
            margin-bottom: 0;
        }
        .result-box {
            background-color: #f8fafc; /* Lighter background for results */
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            margin-top: 20px;
        }
        .result-item {
            margin-bottom: 10px;
        }
        .result-item strong {
            color: #334155;
        }
        #drugSuggestions {
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            background-color: white;
            position: absolute; /* Position relative to parent or body */
            width: calc(100% - 60px); /* Adjust based on container padding */
            z-index: 100; /* Ensure it's above other elements */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        #drugSuggestions div {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f1f5f9;
        }
        #drugSuggestions div:last-child {
            border-bottom: none;
        }
        #drugSuggestions div:hover {
            background-color: #e0e7ff; /* Light blue on hover */
        }
        .error-message {
            color: #ef4444; /* Red for errors */
            margin-top: -10px;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        .info-message {
            color: #22c55e; /* Green for info */
            margin-top: 10px;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Neonatal Renal Dose Calculator</h1>

        <div class="mb-6">
            <div class="section-title">Enter GFR Manually</div>
            <label for="gfrInput">GFR (mL/min/1.73m²):</label>
            <input type="number" id="gfrInput" placeholder="e.g., 45" class="rounded-lg">
            <div id="gfrError" class="error-message hidden">Please enter a valid GFR value.</div>
        </div>

        <div class="mb-6">
            <div class="section-title">Or Calculate GFR</div>
            <div class="radio-group">
                <label>
                    <input type="radio" name="gfrType" value="PT" checked> PT (Pre-Term)
                </label>
                <label>
                    <input type="radio" name="gfrType" value="Term"> Term
                </label>
            </div>
            <label for="lengthInput">Length (cm):</label>
            <input type="number" id="lengthInput" placeholder="e.g., 50" class="rounded-lg">
            <label for="creatinineInput">Creatinine (mg/dl):</label>
            <input type="number" id="creatinineInput" placeholder="e.g., 0.5" step="0.01" class="rounded-lg">
            <button id="calculateGfrBtn" class="w-full rounded-lg">Calculate GFR</button>
            <div id="calcGfrError" class="error-message hidden">Please enter valid Length and Creatinine values.</div>
            <div id="calculatedGfrDisplay" class="info-message hidden">Calculated GFR: <span id="calculatedGfrValue"></span> mL/min/1.73m²</div>
        </div>

        <div class="mb-6 relative">
            <div class="section-title">Find Drug Dose</div>
            <label for="drugNameInput">Drug Name:</label>
            <input type="text" id="drugNameInput" placeholder="Start typing drug name..." class="rounded-lg">
            <div id="drugSuggestions" class="rounded-lg shadow-md"></div>
        </div>

        <div class="result-box hidden" id="doseResult">
            <div class="section-title !mt-0 !mb-0 !pb-0 border-b-0">Dose Information for <span id="selectedDrugName" class="text-indigo-600"></span></div>
            <div class="result-item mt-4">
                <strong>Normal Renal Function Dose:</strong> <span id="normalDose"></span>
            </div>
            <div class="result-item">
                <strong>Adjusted Renal Dose (Based on GFR):</strong> <span id="adjustedDose"></span>
            </div>
            <div class="result-item">
                <strong>GFR Range Applied:</strong> <span id="gfrRangeApplied"></span>
            </div>
            <div class="result-item hidden" id="hdDoseContainer">
                <strong>Hemodialysis (HD) Dose:</strong> <span id="hdDose"></span>
            </div>
            <div class="result-item hidden" id="pdDoseContainer">
                <strong>Peritoneal Dialysis (PD) Dose:</strong> <span id="pdDose"></span>
            </div>
        </div>
        <div id="noDrugFound" class="error-message hidden">No information found for the selected drug or GFR.</div>
    </div>

    <script>
        // Hardcoded drug data based on PDF analysis
        // In a real application, this would be loaded from a structured database or API.
        const drugData = [
            {
                name: "Caspofungin",
                normal: "70 mg/m² loading: 50 mg q24h",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose for normal renal function",
                pd: ""
            },
            {
                name: "Cefaclor",
                normal: "10-15 mg/kgdose/ q8h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose after HD 100% q8-12h",
                pd: "Dose for normal renal function"
            },
            {
                name: "Cefazolin",
                normal: "50-100 mg/kg/day div q8h",
                gfr_10_50: "25 mg/kg q12h",
                gfr_lt_10: "25 mg/kg q24h",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Cefepime",
                normal: "50 mg/kg/dose q12h",
                gfr_10_50: "50 mg/kg q24h",
                gfr_lt_10: "50 mg/kg q48h",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Cefixime",
                normal: "4 mg/kg/dose q12-24 PO",
                gfr_10_50: "75%",
                gfr_lt_10: "50%",
                hd: "ND; dose for GFR 10",
                pd: "Dase for GFR 10-50"
            },
            {
                name: "Cefoperazone",
                normal: "25-60 mg/kg/dose q6-12h IV, IM",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "None Dose after dialysis",
                pd: "None"
            },
            {
                name: "Celoperazone sulbactum",
                normal: "20-40 mg/kg/dose each of cefoperazone and sulbactum",
                gfr_10_50: "Maximum sulbactum 2 g day div q12h (GFR 15-30)",
                gfr_lt_10: "Maximum sulbactum 1 g/ day div q12h (GFR 15-30)",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Cefotaxime",
                normal: "100-200 mg/kg/day div q6-8h IV",
                gfr_10_50: "100%",
                gfr_lt_10: "50%",
                hd: "ND: Dose for GFR <10",
                pd: "912h"
            },
            {
                name: "Ceftriaxone",
                normal: "50-100 mg/kg/day div q12-24h IV, IM",
                gfr_10_50: "100%",
                gfr_lt_10: "50 mg/kg q 24h",
                hd: "Dose after dialysis ND max 2 g",
                pd: "Dose for GFR 10-50"
            },
            {
                name: "Ceftazidime",
                normal: "100-150 mg/kg/day div q8h",
                gfr_10_50: "q8-12h",
                gfr_lt_10: "q12-24h",
                hd: "50 mg/kg q 48h",
                pd: "50 mg/kg q 48h"
            },
            {
                name: "Betamethasone",
                normal: "0.01-0.25 mg/kg/dose div q6-8h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "No data",
                pd: "No data"
            },
            {
                name: "Captopril",
                normal: "0.3-5mg/kg/dose q8h PO",
                gfr_10_50: "75%",
                gfr_lt_10: "50%",
                hd: "50%",
                pd: "50%"
            },
            {
                name: "Cetirizine",
                normal: "0.25mg/kg/dose q12-24h PO",
                gfr_10_50: "50%",
                gfr_lt_10: "25%",
                hd: "None",
                pd: "No data"
            },
            {
                name: "Chlorambucil",
                normal: "0.1-2mg/kg/dose q24h",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "No data",
                pd: "No data"
            },
            {
                name: "Cyclophosphamide",
                normal: "Follow individual protocol",
                gfr_10_50: "100%",
                gfr_lt_10: "75%",
                hd: "50% after HD",
                pd: "Dose for GFR 10"
            },
            {
                name: "Cyclosporine A",
                normal: "1.5-2.5 mg/kg/dose q12h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "None",
                pd: "None"
            },
            {
                name: "Dexamethasone",
                normal: "0.1-0.25 mg/kg/dose q6h IV, PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "No data",
                pd: "No data"
            },
            {
                name: "Digoxin",
                normal: "15 mcg/kg/dose stat 5 mcg/kg 6 h later, then 3-5 mcg/kg q12h PO",
                gfr_10_50: "25-75%",
                gfr_lt_10: "10-25%",
                hd: "None",
                pd: "None"
            },
            {
                name: "Dobutamine",
                normal: "1-20 mcg/kg/dose q6-8h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "Avoid",
                hd: "No data",
                pd: "No data"
            },
            {
                name: "Enalapril",
                normal: "0.1-0.6mg/kg/day, div q12-24h",
                gfr_10_50: "75%",
                gfr_lt_10: "25-50%",
                hd: "Dose for GFR 10",
                pd: "Dose for GPR 10-50"
            },
            {
                name: "Cefuroxime sodium",
                normal: "25 mg/kg/dose q8h IV",
                gfr_10_50: "q24h",
                gfr_lt_10: "q12h",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Cephalexin",
                normal: "25-50 mg/kg/day div q6-8h PO",
                gfr_10_50: "q12-24h",
                gfr_lt_10: "q8-12h",
                hd: "Dose for GFR <10",
                pd: "Dose after dialysis"
            },
            {
                name: "Cloramphenicol",
                normal: "40 mg/kg stat: 25 mg/kg q6h IV, IM, PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose for normal renal function",
                pd: "Dose for normal renal function"
            },
            {
                name: "Chlorne", // This drug name is ambiguous in the PDF.
                normal: "10 mg/kg/dose q24h PO for 3 days or 4mg/kg/dose q12h IM for 3 days",
                gfr_10_50: "100%",
                gfr_lt_10: "50%",
                hd: "ND; Dose for GFR <10",
                pd: "ND: Dose for GFR <10"
            },
            {
                name: "Ciprofloxacin",
                normal: "PO: 20 mg/kg/day, div q12h IV: 10 mg/kg/day, div q12h",
                gfr_10_50: "100% q24h",
                gfr_lt_10: "100% q18h",
                hd: "ND; dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Clarithromycin",
                normal: "7.5-15 mg/kg/dose q12h PO",
                gfr_10_50: "75%",
                gfr_lt_10: "50-75% q24h",
                hd: "Dose after dialysis",
                pd: "None"
            },
            {
                name: "Clindamycin",
                normal: "10-30 mg/kg/day, div q6-8h",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "None",
                pd: "None"
            },
            {
                name: "Co-amoxiclav",
                normal: "IV: 30 mg/kg q8h",
                gfr_10_50: "q12h",
                gfr_lt_10: "q24h",
                hd: "Dose after dialysis",
                pd: "Dose for GFR <10"
            },
            {
                name: "Colistin",
                normal: "2.5-5 mg/kg/day div q6-12h",
                gfr_10_50: "2.5 mg/kg/d div q12-24h",
                gfr_lt_10: "1.5 mg/kg q36h",
                hd: "Dose for GFR <10",
                pd: "ND; dose after"
            },
            {
                name: "Cotrimoxazole",
                normal: "6-10 mg/kg/day div q12h",
                gfr_10_50: "q12h",
                gfr_lt_10: "50% dose",
                hd: "Dose after dialysis",
                pd: "Dose for GFR 10"
            },
            {
                name: "Erythromycin",
                normal: "10 mg/kg/dose q6h IV, PO",
                gfr_10_50: "100%",
                gfr_lt_10: "50-75%",
                hd: "ND, dose for Gift 10",
                pd: "ND, dose for GIR <10"
            },
            {
                name: "Fluconazole",
                normal: "12 mg/kg stat; 6 mg/kg q24h, IV, PO for esophageal and invasive candidiasis; 50% dose for oropharyngeal candidiasis",
                gfr_10_50: "100%",
                gfr_lt_10: "50%",
                hd: "50% dose daily or 100% after HD",
                pd: "Dose for normal renal function"
            },
            {
                name: "Ganciclovir",
                normal: "5 mg/kg q12h IV for 2-3 weeks; 5 mg/kg q24h IV",
                gfr_10_50: "25-50% q24",
                gfr_lt_10: "50% q12h",
                hd: "Dose after HD",
                pd: "Dose for GFR <10"
            },
            {
                name: "Gentamicin",
                normal: "2-2.5 mg/kg q8h; or 5-7.5 mg/kg q24h IV",
                gfr_10_50: "2 mg/kg q12h or q24h",
                gfr_lt_10: "2 mg/kg q48-72h",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Imipenem-cilastatin",
                normal: "25 mg/kg/dose q6h IV",
                gfr_10_50: "50% q8h",
                gfr_lt_10: "25% q12h",
                hd: "Dose after dialysis",
                pd: "Dose for GFR <10"
            },
            {
                name: "Itraconazole",
                normal: "3-5 mg/kg/dose q12-24h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "ND; dose for GFR <10",
                pd: "ND; dose for GFR, <10"
            },
            {
                name: "Lamivudine",
                normal: "4 mg/kg q12h (chronic hepatitis B)",
                gfr_10_50: "2 mg/kg q24h",
                gfr_lt_10: "4 mg/kg q24 h",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Penicillin V",
                normal: "25-50 mg/kg/day div q6-8h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose after dialysis",
                pd: "Dose for Gf R 10"
            },
            {
                name: "Piperacillin",
                normal: "150-300 mg/kg/day, div 6-8h",
                gfr_10_50: "100% q6-8h",
                gfr_lt_10: "100% q8h",
                hd: "Dose after dialysis",
                pd: "Dose for GFR 10"
            },
            {
                name: "Piperacillin and tazobactum",
                normal: "As per piperacillin component",
                gfr_10_50: "100%",
                gfr_lt_10: "70% q6h",
                hd: "Dose after dialysis",
                pd: "Dose for GFR <10"
            },
            {
                name: "Quinine",
                normal: "10 mg/kg/dose q8h IV 7-10 days",
                gfr_10_50: "q8h",
                gfr_lt_10: "q24h",
                hd: "Dose after dialysis",
                pd: "Dose for GFR 10"
            },
            {
                name: "Teicoplanin",
                normal: "10 mg/kg q12h for 3 doses, then 10 mg/kg 24h",
                gfr_10_50: "100%; q24h",
                gfr_lt_10: "50%",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Tetracycline",
                normal: "Over 8 yr: 25-50 mg/day q6h PO",
                gfr_10_50: "50%",
                gfr_lt_10: "q24h",
                hd: "ND; dose for GFR <10",
                pd: "ND; dose for GFR <10"
            },
            {
                name: "Tigecycline",
                normal: "Loading 1.5 mg/kg; 1 mg/kg/dose q12h",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "ND; dose for normal function",
                pd: "ND; dose for normal renal function"
            },
            {
                name: "Tobramycin",
                normal: "2-2.5 mg/kg/dose q6-8h IV, IM",
                gfr_10_50: "1-2 mg/kg; measure levels",
                gfr_lt_10: "1 mg/kg",
                hd: "full dose after HD",
                pd: "Dose for GFR <10"
            },
            {
                name: "Trimethoprim",
                normal: "3-4 mg/kg/dose q12h IV, PO",
                gfr_10_50: "q12h",
                gfr_lt_10: "q24h",
                hd: "Dose after dialysis",
                pd: "q24h"
            },
            {
                name: "Valganciclovir",
                normal: "450 mg/m²/d (130 mg/kg/d) for induction q12h for maintenance",
                gfr_10_50: "q24h",
                gfr_lt_10: "q24-48h",
                hd: "Dose for GFR <10",
                pd: "Dose after dialysis"
            },
            {
                name: "Vancomycin",
                normal: "10-15 mg/kg q6-8h",
                gfr_10_50: "100%",
                gfr_lt_10: "10 mg/kg q24h",
                hd: "Dose after dialysis",
                pd: "Dose for GFR <10"
            },
            {
                name: "Voriconazole",
                normal: "6 mg/kg q12h on 1 day then 4 mg/kg q12h",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose after dialysis",
                pd: "Dose for GFR <10"
            },
            {
                name: "Acetaminophen",
                normal: "10-15 mg/kg/dose q4-6h PO",
                gfr_10_50: "q4h",
                gfr_lt_10: "q6h",
                hd: "None",
                pd: "None"
            },
            {
                name: "Acetazolamide",
                normal: "5-10 mg/kg/dose q6h PO",
                gfr_10_50: "q6h",
                gfr_lt_10: "q12h",
                hd: "No data",
                pd: "No data"
            },
            {
                name: "Acetylsalicylic acid",
                normal: "10-15 mg/kg q4-6h PO",
                gfr_10_50: "q4h",
                gfr_lt_10: "q4-6h",
                hd: "Dose after dialysis",
                pd: "None"
            },
            {
                name: "Amlodipine",
                normal: "0.05-0.6 mg/kg q24h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "None",
                pd: "None"
            },
            {
                name: "Atenolol",
                normal: "0.5-1 mg/kg/dose PO q12-24hr",
                gfr_10_50: "1 mg/kg q24h",
                gfr_lt_10: "1 mg/kg q48h",
                hd: "½ full dose after dialysis",
                pd: "None"
            },
            {
                name: "Azathioprine",
                normal: "1-3 mg/kg/dose q24h PO",
                gfr_10_50: "75%",
                gfr_lt_10: "50%",
                hd: "50% dose after HD",
                pd: "50% of normal dose"
            },
            {
                name: "Enoxaparin",
                normal: "1.2 mg/kg/dose q12h",
                gfr_10_50: "1 mg/kg q24h",
                gfr_lt_10: "1 mg/kg q24h",
                hd: "Dose for GFR <30", // As per PDF, this was in HD column for <30
                pd: "Dase for GFR 30" // As per PDF, this was in PD column for 30
            },
            {
                name: "Insulin (Regular)",
                normal: "0.05-0.2 IU/kg/dose sc prn",
                gfr_10_50: "75%",
                gfr_lt_10: "50%",
                hd: "None",
                pd: "None"
            },
            {
                name: "Lisinopril",
                normal: "0.05-0.6 mg/kg q24h PO",
                gfr_10_50: "50%",
                gfr_lt_10: "25%",
                hd: "25%",
                pd: "25%"
            },
            {
                name: "Methyldopa",
                normal: "10-65 mg/kg/day div q6-12h PO",
                gfr_10_50: "q8-12h",
                gfr_lt_10: "q12-24h",
                hd: "Dose after dialysis",
                pd: "None"
            },
            {
                name: "Methylprednisolone",
                normal: "0.5-1 mg/kg/dose q6-24 IV, IM, PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose for normal function",
                pd: "No data"
            },
            {
                name: "Metoclopramide",
                normal: "0.15-0.3 mg/kg/dose q6h IV, IM, PO",
                gfr_10_50: "75%",
                gfr_lt_10: "50%",
                hd: "None",
                pd: "No data"
            },
            {
                name: "Nitroprusside",
                normal: "0.5-10 mcg/kg/min by infusion",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "None",
                pd: "None"
            },
            {
                name: "Omeprazole",
                normal: "0.4-0.8 mg/kg/dose q12-24 hr PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "No data",
                pd: "None"
            },
            {
                name: "Ondansetron",
                normal: "0.1-0.2 mg/kg/dose q6-12 h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "No data",
                pd: "No data"
            },
            {
                name: "Prazosin",
                normal: "5 mcg/kg test; 0.025-0.1 mg/kg/dose q6h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "None",
                pd: "None"
            },
            {
                name: "Prednisolone",
                normal: "2 mg/kg/dose q24h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Yes",
                pd: "No data"
            },
            {
                name: "Ranitidine",
                normal: "2-4 mg/kg q8-12h PO",
                gfr_10_50: "75%",
                gfr_lt_10: "50%",
                hd: "½ dose",
                pd: "Dose for GFR 10 50"
            },
            {
                name: "Spironolactone",
                normal: "6.25-25 mg q12h PO",
                gfr_10_50: "q6-12h",
                gfr_lt_10: "q12-24h",
                hd: "Avoid",
                pd: "NA"
            },
            {
                name: "Warfarin",
                normal: "0.05-0.2 mg/kg q24h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "None",
                pd: "None"
            },
            {
                name: "Ethambutol",
                normal: "25 mg/kg/dose q24h PO",
                gfr_10_50: "q24h",
                gfr_lt_10: "q24-36h",
                hd: "Dose after dialysis",
                pd: "Dose for GFR 10-50"
            },
            {
                name: "Isoniazid",
                normal: "10-15 mg/kg/dose q24h IV, IM, PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose after dialysis",
                pd: "Dose for normal renal function"
            },
            {
                name: "Pyrazinamide",
                normal: "20-35 mg/kg/dose q24h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "50-100%",
                hd: "Dose for GFR <10 or 25-30 mg/kg post HD",
                pd: "Dose for normal renal function"
            },
            {
                name: "Rifampin",
                normal: "10 mg/kg/day q24h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "ND Dose for GFR <10",
                pd: "ND Dose for GFR <10"
            },
            {
                name: "Streptomycin",
                normal: "20-30 mg/kg/dose q24h IM",
                gfr_10_50: "7.5 mg/kg q24h",
                gfr_lt_10: "7.5 mg/kg q48 h",
                hd: "7.5 mg/kg q72-96h",
                pd: "Dose for GFR 10-50 and measure levels"
            },
            {
                name: "Carbamazepine",
                normal: "2-10 mg/kg/dose q8h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Phenobarbital",
                normal: "5 mg/kg/dose q24h TV IMPO",
                gfr_10_50: "100% avoid large single dose",
                gfr_lt_10: "25-50 avoid large single dose",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR 10"
            },
            {
                name: "Clonazepam",
                normal: "0.05-0.2 mg/kg/d",
                gfr_10_50: "100%",
                gfr_lt_10: "75%",
                hd: "ND; dose for GFR 10",
                pd: "Dose for GFR 10"
            },
            {
                name: "Lamotrigine",
                normal: "0.3 mg/kg/day for 2 weeks: 0.6 mg/kq for weeks, then 4.5-75 mg/kg/day div q12h maintenance",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR 10"
            },
            {
                name: "Levetiracetam",
                normal: "10-60 mg/kg/d, div 8 h",
                gfr_10_50: "50%",
                gfr_lt_10: "50%",
                hd: "50% dose after dialysis",
                pd: "Dose for GFR <10"
            },
            {
                name: "Phenytoin",
                normal: "5-8 mg/kg/d",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose after dialysis",
                pd: "Dose for GFR 10"
            },
            {
                name: "Topiramate",
                normal: "3-9 mg/kg/d, div 8-12 h",
                gfr_10_50: "50%",
                gfr_lt_10: "50%",
                hd: "Dose after dialysis",
                pd: "Dose for GFR <10"
            },
            {
                name: "Valproate sodium",
                normal: "10-60 mg/kg/d",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose after dialysis",
                pd: "Dose for GFR <TD"
            },
            {
                name: "Levofloxacin",
                normal: "/kg/dose q12-24h IV, PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100% q48h",
                hd: "Dase for GER <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Linezolid",
                normal: "10 mg/kg/dose q8h",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose for GFR 10",
                pd: "Dose after dialysis"
            },
            {
                name: "Meropenem",
                normal: "10-20 mg/kg/dose q8h IV",
                gfr_10_50: "100%",
                gfr_lt_10: "50% q24h",
                hd: "Dose after dialysis",
                pd: "Dose for GFR <10"
            },
            {
                name: "Metronidazole",
                normal: "10 mg/kg/dose q8 IV, PO, PR",
                gfr_10_50: "100%",
                gfr_lt_10: "100%",
                hd: "Dose for GFR <10",
                pd: "Dose after dialysis"
            },
            {
                name: "Netilmicin",
                normal: "2-2.5 mg/kg/dose q8h IV",
                gfr_10_50: "100%",
                gfr_lt_10: "2 mg/kg q24h",
                hd: "2 mg/kg q48h",
                pd: "2 mg/kg after HD"
            },
            {
                name: "Nitrofurantoin",
                normal: "5-7 mg/kgday /divided q6h PO",
                gfr_10_50: "100%",
                gfr_lt_10: "Avoid",
                hd: "Avoid",
                pd: "Avoid"
            },
            {
                name: "Ofloxacin",
                normal: "15 mg/kg/day divided 12h, IV, PO",
                gfr_10_50: "100%",
                gfr_lt_10: "100% q24h",
                hd: "Dose for GFR <10",
                pd: "Dose for GFR <10"
            },
            {
                name: "Oseltamivir",
                normal: "75 mg q12h treatment; q24h prophylaxis, PO (weight >40 kg)",
                gfr_10_50: "100%",
                gfr_lt_10: "50% once for therapy; q48h for prophylaxis",
                hd: "Dose for GFR <10",
                pd: "50% after alternate dialysis"
            },
            {
                name: "Penicillin G",
                normal: "100-250,000 U/kg/day, div q4-6h",
                gfr_10_50: "q4-6h",
                gfr_lt_10: "q12-18h",
                hd: "Dose for GFR <10",
                pd: "Dose after dialysis"
            }
        ];

        // Get DOM elements
        const gfrInput = document.getElementById('gfrInput');
        const gfrError = document.getElementById('gfrError');
        const gfrTypeRadios = document.querySelectorAll('input[name="gfrType"]');
        const lengthInput = document.getElementById('lengthInput');
        const creatinineInput = document.getElementById('creatinineInput');
        const calculateGfrBtn = document.getElementById('calculateGfrBtn');
        const calcGfrError = document.getElementById('calcGfrError');
        const calculatedGfrDisplay = document.getElementById('calculatedGfrDisplay');
        const calculatedGfrValue = document.getElementById('calculatedGfrValue');
        const drugNameInput = document.getElementById('drugNameInput');
        const drugSuggestions = document.getElementById('drugSuggestions');
        const doseResult = document.getElementById('doseResult');
        const selectedDrugName = document.getElementById('selectedDrugName');
        const normalDose = document.getElementById('normalDose');
        const adjustedDose = document.getElementById('adjustedDose');
        const gfrRangeApplied = document.getElementById('gfrRangeApplied');
        const hdDoseContainer = document.getElementById('hdDoseContainer');
        const hdDose = document.getElementById('hdDose');
        const pdDoseContainer = document.getElementById('pdDoseContainer');
        const pdDose = document.getElementById('pdDose');
        const noDrugFound = document.getElementById('noDrugFound');

        let currentGFR = null; // Stores the GFR value to be used for dose calculation
        let selectedDrug = null; // Stores the currently selected drug object

        // Function to calculate eGFR
        function calculateGFR() {
            const type = document.querySelector('input[name="gfrType"]:checked').value;
            const length = parseFloat(lengthInput.value);
            const creatinine = parseFloat(creatinineInput.value);

            // Validate inputs
            if (isNaN(length) || isNaN(creatinine) || length <= 0 || creatinine <= 0) {
                calcGfrError.classList.remove('hidden');
                calculatedGfrDisplay.classList.add('hidden');
                return null;
            } else {
                calcGfrError.classList.add('hidden');
            }

            let calculatedValue;
            if (type === 'PT') {
                calculatedValue = (0.34 * length) / creatinine;
            } else { // Term
                calculatedValue = (0.45 * length) / creatinine;
            }

            // Display calculated GFR
            calculatedGfrValue.textContent = calculatedValue.toFixed(2);
            calculatedGfrDisplay.classList.remove('hidden');

            // Set currentGFR for dose calculation
            currentGFR = calculatedValue;
            gfrInput.value = calculatedValue.toFixed(2); // Also update manual GFR input
            gfrError.classList.add('hidden'); // Hide manual GFR error if calculation is successful
            updateDrugDoseDisplay(); // Update dose display if a drug is already selected
            return calculatedValue;
        }

        // Event listener for GFR calculation button
        calculateGfrBtn.addEventListener('click', calculateGFR);

        // Event listener for manual GFR input
        gfrInput.addEventListener('input', () => {
            const gfr = parseFloat(gfrInput.value);
            if (isNaN(gfr) || gfr < 0) {
                gfrError.classList.remove('hidden');
                currentGFR = null;
            } else {
                gfrError.classList.add('hidden');
                currentGFR = gfr;
            }
            // Clear calculated GFR display if manual GFR is being used
            calculatedGfrDisplay.classList.add('hidden');
            updateDrugDoseDisplay();
        });

        // Event listener for drug name input (autocomplete)
        drugNameInput.addEventListener('input', () => {
            const query = drugNameInput.value.toLowerCase();
            drugSuggestions.innerHTML = ''; // Clear previous suggestions

            if (query.length < 2) {
                drugSuggestions.classList.add('hidden');
                return;
            }

            const filteredDrugs = drugData.filter(drug =>
                drug.name.toLowerCase().includes(query)
            );

            if (filteredDrugs.length > 0) {
                drugSuggestions.classList.remove('hidden');
                filteredDrugs.forEach(drug => {
                    const div = document.createElement('div');
                    div.textContent = drug.name;
                    div.addEventListener('click', () => {
                        drugNameInput.value = drug.name;
                        selectedDrug = drug;
                        drugSuggestions.classList.add('hidden');
                        updateDrugDoseDisplay();
                    });
                    drugSuggestions.appendChild(div);
                });
            } else {
                drugSuggestions.classList.add('hidden');
            }
        });

        // Hide suggestions when clicking outside
        document.addEventListener('click', (event) => {
            if (!drugNameInput.contains(event.target) && !drugSuggestions.contains(event.target)) {
                drugSuggestions.classList.add('hidden');
            }
        });

        // Function to update the drug dose display
        function updateDrugDoseDisplay() {
            // Hide HD/PD containers by default
            hdDoseContainer.classList.add('hidden');
            pdDoseContainer.classList.add('hidden');

            if (!selectedDrug || currentGFR === null) {
                doseResult.classList.add('hidden');
                noDrugFound.classList.remove('hidden');
                return;
            }

            selectedDrugName.textContent = selectedDrug.name;
            normalDose.textContent = selectedDrug.normal || 'N/A';

            let adjusted = 'N/A';
            let gfrRange = 'N/A';

            if (currentGFR >= 50) {
                adjusted = selectedDrug.normal || 'No adjustment needed';
                gfrRange = '>50 mL/min/1.73m² (Normal Function)';
            } else if (currentGFR >= 10 && currentGFR < 50) {
                adjusted = selectedDrug.gfr_10_50 || 'Information not available for this GFR range';
                gfrRange = '10-50 mL/min/1.73m²';
            } else if (currentGFR < 10) {
                adjusted = selectedDrug.gfr_lt_10 || 'Information not available for this GFR range';
                gfrRange = '<10 mL/min/1.73m²';

                // Show HD/PD information if GFR is < 10 and data exists
                if (selectedDrug.hd && selectedDrug.hd.trim() !== '' && selectedDrug.hd.toLowerCase() !== 'no data' && selectedDrug.hd.toLowerCase() !== 'na') {
                    hdDose.textContent = selectedDrug.hd;
                    hdDoseContainer.classList.remove('hidden');
                }
                if (selectedDrug.pd && selectedDrug.pd.trim() !== '' && selectedDrug.pd.toLowerCase() !== 'no data' && selectedDrug.pd.toLowerCase() !== 'na') {
                    pdDose.textContent = selectedDrug.pd;
                    pdDoseContainer.classList.remove('hidden');
                }
            } else {
                adjusted = 'Please enter a valid GFR to see adjusted dose.';
                gfrRange = 'Invalid GFR';
            }

            adjustedDose.textContent = adjusted;
            gfrRangeApplied.textContent = gfrRange;
            doseResult.classList.remove('hidden');
            noDrugFound.classList.add('hidden');
        }

        // Initial update in case of pre-filled values (though not expected in this setup)
        updateDrugDoseDisplay();
    </script>
</body>
</html>
